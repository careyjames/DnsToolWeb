<!DOCTYPE html>
<html lang="en" data-bs-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#212529">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>DNS Tool - DNS & Email Security Intelligence</title>
    <meta name="description" content="Comprehensive DNS intelligence tool for IT professionals. Check SPF, DKIM, DMARC, DNSSEC, BIMI, and more. Get a complete security posture report in seconds.">
    
    <!-- Preconnect to external domains for faster loading -->
    <link rel="preconnect" href="https://cdn.replit.com" crossorigin>
    <link rel="preconnect" href="https://cdnjs.cloudflare.com" crossorigin>
    <link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin>
    <link rel="dns-prefetch" href="https://cdn.replit.com">
    <link rel="dns-prefetch" href="https://cdnjs.cloudflare.com">
    
    <!-- Facebook / Open Graph -->
    <meta property="og:url" content="https://dnstool.it-help.tech/">
    <meta property="og:type" content="website">
    <meta property="og:title" content="DNS Tool - DNS & Email Security Intelligence">
    <meta property="og:description" content="Comprehensive DNS intelligence for IT professionals. Check SPF, DKIM, DMARC, DNSSEC, BIMI and get a complete security posture report in seconds.">
    <meta property="og:image" content="https://dnstool.it-help.tech/static/images/og-image.png">
    
    <!-- Twitter -->
    <meta name="twitter:card" content="summary_large_image">
    <meta property="twitter:domain" content="dnstool.it-help.tech">
    <meta property="twitter:url" content="https://dnstool.it-help.tech/">
    <meta name="twitter:title" content="DNS Tool - DNS & Email Security Intelligence">
    <meta name="twitter:description" content="Comprehensive DNS intelligence for IT professionals. Check SPF, DKIM, DMARC, DNSSEC, BIMI and get a complete security posture report in seconds.">
    <meta name="twitter:image" content="https://dnstool.it-help.tech/static/images/og-image.png">
    
    <!-- JSON-LD Schema -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "WebApplication",
        "name": "DNS Tool",
        "description": "Comprehensive DNS analysis and email security intelligence tool for IT professionals. Check SPF, DKIM, DMARC, DNSSEC, BIMI, and get a complete security posture report.",
        "url": "https://dnstool.it-help.tech",
        "applicationCategory": "SecurityApplication",
        "operatingSystem": "Web Browser",
        "offers": {
            "@type": "Offer",
            "price": "0",
            "priceCurrency": "USD"
        },
        "author": {
            "@type": "Organization",
            "name": "IT Help San Diego Inc.",
            "url": "https://www.it-help.tech",
            "telephone": "+1-619-853-5008",
            "address": {
                "@type": "PostalAddress",
                "addressLocality": "La Jolla",
                "addressRegion": "CA",
                "postalCode": "92037",
                "addressCountry": "US"
            }
        },
        "potentialAction": {
            "@type": "SearchAction",
            "target": "https://dnstool.it-help.tech/analyze?domain={domain}",
            "query-input": "required name=domain"
        }
    }
    </script>
    
    <!-- Critical inline CSS for initial render -->
    <style nonce="{{ csp_nonce }}">
        :root{--bs-body-bg:#212529;--bs-body-color:#dee2e6;--bs-primary:#0d6efd;--bs-secondary:#6c757d}
        *,::after,::before{box-sizing:border-box}
        body{margin:0;font-family:-apple-system,BlinkMacSystemFont,"SF Pro Text",system-ui,"Segoe UI",Roboto,"Helvetica Neue",Arial,sans-serif;background-color:var(--bs-body-bg);color:var(--bs-body-color);line-height:1.5;-webkit-font-smoothing:antialiased}
        .navbar{display:flex;padding:.5rem 1rem;background-color:#212529!important}
        .navbar-brand{color:#fff;text-decoration:none;font-size:1.25rem;padding:.3125rem 0}
        .container{width:100%;max-width:1140px;margin:0 auto;padding:0 .75rem}
        .text-center{text-align:center}
        .my-5{margin-top:3rem;margin-bottom:3rem}
        main.container{min-height:50vh}
        .fas,.fab,.far,.fa{display:inline-block;width:1em;height:1em;min-width:1em;vertical-align:-0.125em}
        .mb-3,.mb-4,.mb-5{margin-bottom:1rem}
        .display-4{font-size:2.5rem;font-weight:300;line-height:1.2}
        .lead{font-size:1.25rem;font-weight:300}
        .text-muted{color:#adb5bd!important}
        .card{background-color:#2b3035;border:1px solid #495057;border-radius:.375rem}
        .card-body{padding:1rem}
        .form-control{display:block;width:100%;padding:.375rem .75rem;font-size:1rem;background-color:#2b3035;border:1px solid #495057;border-radius:.375rem;color:#dee2e6}
        .btn{display:inline-block;padding:.375rem .75rem;font-size:1rem;border-radius:.375rem;text-decoration:none;cursor:pointer}
        .btn-primary{background-color:var(--bs-primary);border:1px solid var(--bs-primary);color:#fff}
        .input-group{display:flex;flex-wrap:wrap}
        .input-group>.form-control{flex:1 1 auto;width:1%}
        .row{display:flex;flex-wrap:wrap;margin:0 -.75rem}
        .col-lg-8{padding:0 .75rem}
        @media(min-width:992px){.col-lg-8{flex:0 0 66.666667%;max-width:66.666667%}}
        .justify-content-center{justify-content:center}
        .badge{display:inline-block;padding:.35em .65em;font-size:.75em;font-weight:700;border-radius:.25rem;background-color:var(--bs-secondary)}
        .navbar-nav{display:flex;list-style:none;margin:0;padding:0}
        .nav-link{color:rgba(255,255,255,.55);text-decoration:none;padding:.5rem 1rem}
        .d-none{display:none}
        .collapse:not(.show){display:none}
        @media(min-width:992px){.collapse.navbar-collapse{display:flex!important}}
    </style>
    <!-- Load Bootstrap first (sync) to prevent CLS when it applies styles -->
    <link rel="stylesheet" href="https://cdn.replit.com/agent/bootstrap-agent-dark-theme.min.css">
    <link href="{{ url_for('static', filename='css/custom.css') }}" rel="stylesheet">
    <!-- Font Awesome loaded synchronously for CSP compliance -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
        <div class="container">
            <a class="navbar-brand" href="{{ url_for('index') }}">
                <i class="fas fa-globe me-2"></i>DNS Tool <span class="badge bg-info text-dark ms-1">v{{ app_version }}</span>
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link active" href="{{ url_for('index') }}">
                            <i class="fas fa-home me-1"></i>Home
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('history') }}">
                            <i class="fas fa-history me-1"></i>History
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('stats') }}">
                            <i class="fas fa-chart-bar me-1"></i>Statistics
                        </a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <main class="container my-5">
        <!-- Header -->
        <div class="text-center mb-5">
            <h1 class="display-4 mb-3">
                DNS Tool
            </h1>
            <p class="lead text-muted">
                Comprehensive DNS record analysis, email security validation, and domain DNS intelligence report
            </p>
        </div>

        <!-- Flash messages -->
        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                {% for category, message in messages %}
                    <div class="alert alert-{{ 'danger' if category == 'danger' else 'warning' if category == 'warning' else 'success' }} alert-dismissible fade show" role="alert">
                        <i class="fas fa-{{ 'exclamation-triangle' if category in ['danger', 'warning'] else 'check-circle' }} me-2"></i>
                        {{ message }}
                        <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                    </div>
                {% endfor %}
            {% endif %}
        {% endwith %}

        <!-- Main form -->
        <div class="row justify-content-center">
            <div class="col-lg-8">
                <div class="card shadow-sm">
                    <div class="card-body p-4">
                        <form method="POST" action="{{ url_for('analyze') }}" id="domainForm">
                            <div class="mb-4">
                                <label for="domain" class="form-label h5">
                                    <i class="fas fa-search me-2"></i>Domain Name
                                </label>
                                <div class="input-group input-group-lg">
                                    <input type="text" 
                                           class="form-control" 
                                           id="domain" 
                                           name="domain" 
                                           placeholder="example.com" 
                                           required
                                           autocomplete="off">
                                    <button class="btn btn-primary" type="submit" id="analyzeBtn" aria-label="Analyze domain">
                                        <i class="fas fa-search me-2" aria-hidden="true"></i>Analyze
                                    </button>
                                </div>
                                <div class="form-text">
                                    <i class="fas fa-info-circle me-1"></i>
                                    Enter the raw domain (e.g., <strong>example.com</strong>) â€” no https://. Pro tip: <strong>www</strong> is just a subdomain, the same way DKIM selectors like <strong>google._domainkey</strong> are.
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>

        <!-- Features overview -->
        <div class="row mt-5">
            <div class="col-12">
                <h2 class="text-center mb-4">What We Analyze</h2>
            </div>
            <div class="col-md-6 col-lg-3 mb-4">
                <div class="card h-100 border-0 bg-transparent">
                    <div class="card-body text-center">
                        <div class="feature-icon mb-3">
                            <i class="fas fa-server fa-2x text-primary"></i>
                        </div>
                        <h3 class="card-title h5">DNS Records</h3>
                        <p class="card-text text-muted">A, AAAA, MX, TXT, and NS records from multiple resolvers</p>
                    </div>
                </div>
            </div>
            <div class="col-md-6 col-lg-3 mb-4">
                <div class="card h-100 border-0 bg-transparent">
                    <div class="card-body text-center">
                        <div class="feature-icon mb-3">
                            <i class="fas fa-shield-alt fa-2x text-success"></i>
                        </div>
                        <h3 class="card-title h5">Email Security</h3>
                        <p class="card-text text-muted">SPF, DMARC, and DKIM validation with security recommendations</p>
                    </div>
                </div>
            </div>
            <div class="col-md-6 col-lg-3 mb-4">
                <div class="card h-100 border-0 bg-transparent">
                    <div class="card-body text-center">
                        <div class="feature-icon mb-3">
                            <i class="fas fa-building fa-2x text-info"></i>
                        </div>
                        <h3 class="card-title h5">Registrar Info</h3>
                        <p class="card-text text-muted">Domain registration details via RDAP and WHOIS lookup</p>
                    </div>
                </div>
            </div>
            <div class="col-md-6 col-lg-3 mb-4">
                <div class="card h-100 border-0 bg-transparent">
                    <div class="card-body text-center">
                        <div class="feature-icon mb-3">
                            <i class="fas fa-network-wired fa-2x text-warning"></i>
                        </div>
                        <h3 class="card-title h5">Authoritative</h3>
                        <p class="card-text text-muted">Direct queries to authoritative nameservers for accuracy</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <footer class="text-center mt-5 mb-4 text-muted small">
            <p class="mb-0">Made by <a href="https://it-help.tech" target="_blank" class="text-info">IT Help San Diego Inc.</a></p>
        </footer>
    </main>

    <!-- Loading Overlay -->
    <div id="loadingOverlay" class="loading-overlay d-none">
        <div class="loading-content">
            <div class="loading-spinner">
                <i class="fas fa-globe fa-spin"></i>
            </div>
            <h4 class="mt-4 mb-2">Analyzing Domain</h4>
            <p class="text-muted mb-0" id="loadingDomain"></p>
            <div class="loading-dots mt-3">
                <span></span><span></span><span></span>
            </div>
            <p class="loading-status mt-3" id="loadingStatus">Initializing DNS resolver...</p>
        </div>
    </div>
    <script nonce="{{ csp_nonce }}">
    (function() {
        var statusMessages = [
            "Initializing DNS resolver...",
            "Querying authoritative nameservers...",
            "Pulling A/AAAA records via DNS over HTTPS...",
            "Fetching MX records for mail routing...",
            "Running RDAP lookup for registrar info...",
            "Parsing SPF record from TXT...",
            "Validating DMARC policy...",
            "Checking DKIM selectors...",
            "Querying DNSSEC chain of trust...",
            "Fetching CAA records...",
            "Checking MTA-STS policy...",
            "Validating BIMI configuration...",
            "Cross-referencing with Cloudflare DNS...",
            "Comparing against Google Public DNS...",
            "Aggregating results from multiple resolvers..."
        ];
        var currentIndex = 0;
        var intervalId = null;
        var isRunning = false;
        
        function cycleMessage() {
            var statusEl = document.getElementById('loadingStatus');
            if (!statusEl) return;
            currentIndex = (currentIndex + 1) % statusMessages.length;
            statusEl.textContent = statusMessages[currentIndex];
        }
        
        function startMessages() {
            if (isRunning) return;
            isRunning = true;
            
            var statusEl = document.getElementById('loadingStatus');
            if (!statusEl) return;
            
            currentIndex = 0;
            statusEl.textContent = statusMessages[0];
            
            // Start cycling every 500ms
            intervalId = setInterval(cycleMessage, 500);
        }
        
        // Expose globally
        window.startLoadingMessages = startMessages;
        
        // Use MutationObserver to detect when overlay becomes visible (via class change)
        document.addEventListener('DOMContentLoaded', function() {
            var overlay = document.getElementById('loadingOverlay');
            if (overlay) {
                var observer = new MutationObserver(function(mutations) {
                    mutations.forEach(function(mutation) {
                        if (mutation.attributeName === 'class') {
                            // Check if d-none class was removed (overlay became visible)
                            if (!overlay.classList.contains('d-none')) {
                                startMessages();
                            }
                        }
                    });
                });
                observer.observe(overlay, { attributes: true, attributeFilter: ['class'] });
            }
        });
    })();
    </script>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js" integrity="sha384-geWF76RCwLtnZ8qwWowPQNguL3RmwHVBC9FhGdlKrxdiJJigb/j/68SIy3Te4Bkz" crossorigin="anonymous" defer></script>
    <script src="{{ url_for('static', filename='js/main.js') }}" defer></script>
</body>
</html>
