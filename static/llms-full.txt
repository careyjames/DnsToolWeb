# DNS Tool - Complete Technical Documentation

## Overview
DNS Tool is an authoritative DNS intelligence platform designed for IT professionals. It provides comprehensive domain analysis and security intelligence including DNS records, email security validation, DNSSEC verification, and domain registration information.

URL: https://dnstool.it-help.tech

## Core Capabilities

### DNS Record Analysis
- A/AAAA Records: IPv4 and IPv6 addresses
- MX Records: Mail exchanger priorities and hostnames
- TXT Records: SPF, DMARC, domain verification tokens
- CNAME Records: Canonical name aliases
- NS Records: Authoritative nameservers
- SOA Records: Start of authority with TTL and refresh intervals
- CAA Records: Certificate Authority Authorization
- SRV Records: Service discovery (_autodiscover, _sip, _caldavs, etc.)

### Email Security Analysis

#### SPF (Sender Policy Framework)
- Validates SPF record syntax
- Counts DNS lookups (10 lookup limit per RFC 7208)
- Analyzes mechanism permissiveness (+all, ~all, -all, ?all)
- Detects no-mail domains (v=spf1 -all pattern)
- RFC 7489 compliance notes for -all with legitimate senders

#### DKIM (DomainKeys Identified Mail)
- Checks common selectors: google, selector1, selector2, default, dkim, mail, k1, s1, s2, email
- Validates key presence and format
- Reports key length when available

#### DMARC (Domain-based Message Authentication)
- Policy analysis (none, quarantine, reject)
- Subdomain policy (sp=) detection
- Percentage (pct=) enforcement level
- Reporting addresses (rua=, ruf=)
- Alignment modes (adkim=, aspf=)

### DNSSEC Validation
- Full chain validation from root to domain
- DS record verification
- DNSKEY analysis
- Algorithm identification (ECDSA P-256/SHA-256, RSA/SHA-256, etc.)
- Trust chain status
- AD (Authentic Data) flag verification via validating resolvers (8.8.8.8, 1.1.1.1)

### MTA-STS (Mail Transfer Agent Strict Transport Security)
- DNS record detection at _mta-sts.{domain}
- Policy file retrieval from .well-known/mta-sts.txt
- Mode analysis (enforce, testing, none)
- MX pattern matching validation
- Max-age verification
- RFC 8461 compliance

### TLS-RPT (TLS Reporting)
- Record detection at _smtp._tls.{domain}
- Reporting endpoint (rua=) validation
- RFC 8460 compliance

### BIMI (Brand Indicators for Message Identification)
- Record detection at default._bimi.{domain}
- Logo URL (l=) validation
- VMC certificate (a=) verification
- SVG accessibility checking

### SMTP Transport Security
- MX server STARTTLS support
- TLS version detection (1.2, 1.3)
- Cipher strength analysis
- Certificate validity checking

### Domain Information (RDAP)
- Registrar name
- Creation/expiration dates
- Nameserver delegation
- Registry information

## Security Posture Scoring

Domains receive a posture rating based on:
- SPF configuration and strictness
- DMARC policy enforcement level
- DKIM key presence
- DNSSEC enablement
- MX record configuration

Posture Levels:
- EXCELLENT: Full email security + DNSSEC
- GOOD: Strong email security controls
- MODERATE: Basic protections in place
- WEAK: Missing critical security records
- CRITICAL: No security controls detected

## Technical Implementation
- Backend: Python/Flask
- DNS Library: dnspython with DoH fallback
- RDAP: Direct IANA bootstrap queries
- Response Time: Typically 2-3 seconds

## API Usage
The tool is web-based. Enter a domain at the homepage to receive analysis.

## RFC References
- RFC 7208: SPF (Sender Policy Framework)
- RFC 6376: DKIM (DomainKeys Identified Mail)
- RFC 7489: DMARC (Domain-based Message Authentication)
- RFC 4033-4035: DNSSEC (DNS Security Extensions)
- RFC 8461: MTA-STS (Mail Transfer Agent Strict Transport Security)
- RFC 8460: TLS-RPT (SMTP TLS Reporting)
- RFC 8659: CAA (Certificate Authority Authorization)
- BIMI Group Specification: Brand Indicators for Message Identification
- RFC 7483: RDAP (Registration Data Access Protocol)

## Contact
IT Help San Diego Inc.
619-853-5008
https://www.it-help.tech/blog/dns-security-best-practices/
